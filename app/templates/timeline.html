{% extends "base.html" %}

{% block body %}

<div class="form">
    <form id="timeline_form" onsubmit="postFormData(event)">
        <label for="name">Name</label>
        <input type="text" name="name" id="name">
        <label for="email">Email</label>
        <input type="text" name="email" id="email">
        <br>
        <input type="text" name="content" id="content">
        <br>
        <input type="submit" value="Post">
    </form>
</div>
<div class="timeline">
    {% for post in timeline['timeline_posts'] %}
        <p>{{ post['created_at'] }}</p>
        <p>{{ post['name'] }}</p>
        <p>{{ post['email'] }}</p>
        <p>{{ post['content'] }}</p>
        <br>
    {% endfor %}
</div>


<script>
    async function postFormData(e) {
        e.preventDefault();

        const form = document.getElementById('timeline_form');
        const formData = new FormData(form);

        try {
            await fetch('/api/timeline_post', {
                method: 'POST',
                body: formData
            })

        } catch (err) {
            console.log('An error occured');
        } finally {
            location.reload()
        }
    }
</script>
{% endblock %}